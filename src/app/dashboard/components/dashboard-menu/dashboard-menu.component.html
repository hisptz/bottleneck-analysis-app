<nav class="navbar navbar-default dashboard-menu">
  <div class="container-fluid" style="padding-left: 0px; padding-right: 0px;">
    <div class="navbar-header">
      <a class="navbar-toggle collapsed dashboard-collapse-btn" data-toggle="collapse" data-target="#idashboardNavbar" [attr.aria-expanded]="!isCollapsed" (click)="toggleCollapse()" [ngClass]="{'collapsed': isCollapsed}">
        <i class="fa fa-bars"></i>
      </a>
    </div>
    <div class="collapse navbar-collapse dashboard-collapse-body" id="idashboardNavbar" [ngClass]="{'in': !isCollapsed}">
      <ul class="nav navbar-nav dashboard-nav">
        <li>
          <a
            (click)="toggleFilter()"
            class="navbar-brand"
          >
            <i class="fa fa-filter"></i>
          </a>
        </li>
        <!--Data filter area-->
        <li
          *ngIf="showFilter.data.shown && showFilter.data.enabled"
          appClickOutside (clickOutside)="showDataFilter = false"
        >
          <a
            class="dimension-filter-btn"
            (click)="showDataFilter = !showDataFilter"
          >
            <img [src]="'assets/img/data.png'" alt="">
            <!--<span>Data</span>-->
          </a>
          <div
            class="data-filter-holder"
            *ngIf="showDataFilter"
          >
            <app-data-filter
              (onDataUpdate)="updateFilters($event)"
              (onDataFilterClose)="showDataFilter = false"
            ></app-data-filter>
          </div>
        </li>
        <!--end of data filter area-->

        <!--Period filter area-->
        <li
          *ngIf="showFilter.period.shown && showFilter.period.enabled"
          appClickOutside (clickOutside)="showPeriodFilter = false"
        >
          <a
            class="dimension-filter-btn"
            (click)="showPeriodFilter = !showPeriodFilter"
          >
            <img [src]="'assets/img/period.png'" alt="">
            <span>Period</span>
          </a>
          <app-period-filter
            *ngIf="showPeriodFilter"
            (onPeriodUpdate)="updateFilters($event)"
            (onPeriodFilterClose)="showPeriodFilter = false"
          >
          </app-period-filter>
        </li>
        <!--End of period filter area-->

        <!--Orgunit filter area-->
        <li
          *ngIf="showFilter.orgUnit.shown && showFilter.orgUnit.enabled"
          appClickOutside (clickOutside)="showOrgUnitFilter = false"
        >
          <a
            class="dimension-filter-btn"
            (click)="showOrgUnitFilter = !showOrgUnitFilter"
          >
            <img [src]="'assets/img/tree.png'" alt="">
            <span>Orgunit</span>
          </a>
          <div
            class="org-unit-filter-holder"
            *ngIf="showOrgUnitFilter"
          >
            <app-org-unit-filter
              (onOrgUnitUpdate)="updateFilters($event)"
              (onOrgUnitClose)="showOrgUnitFilter = !showOrgUnitFilter"
            >
            </app-org-unit-filter>
          </div>
        </li>
        <!--end of orgunit filter area-->

        <!--Settings option area-->
        <li
          *ngIf="showFilter.settings.shown && showFilter.settings.enabled"
        >
          <a
            class="dimension-filter-btn"
          >
            <img [src]="'assets/img/settings.png'" alt="">

          </a>
        </li>
        <!--End of settings options area-->
      <!--<li><a (click)="settingService.toggleItem('dimension')" class="navbar-brand" style="font-size: 14px;"><i class="fa {{settingService.isOpen('dimension') ? 'fa-times' : 'fa-filter'}}"></i></a></li>-->
      <!--<li><a (click)="settingService.toggleItem('share')"><i class="fa {{settingService.isOpen('share') ? 'fa-times' : 'fa-share-alt'}}"></i></a></li>-->
      </ul>
      <!--<app-dashboard-menu-items></app-dashboard-menu-items>-->

      <ul class="nav navbar-nav dashboard-nav"
          *ngIf="(dashboardMenuObject$ | async) !== null && (dashboardMenuObject$ | async).showInGroupFormat"
          appClickOutside (clickOutside)="currentDashboardGroup = ''"
      >
        <li
          class="dropdown {{currentDashboardGroup === dashboardGroup ? 'active': ''}}"
          *ngFor="let dashboardGroup of (dashboardMenuObject$ | async).dashboardsMenuItems.groups"
        >
          <a
            (click)="toggleDashboardGroup(dashboardGroup)"
          >
            {{dashboardGroup}}
            <i class="fa fa-caret-down"></i>
          </a>
          <ul
            *ngIf="currentDashboardGroup === dashboardGroup"
            class="option-dropdown"
          >
            <li
              *ngFor="let dashboardMenuItem of (dashboardMenuObject$ | async).dashboardsMenuItems.dashboards[dashboardGroup]"
            >
              <a
                routerLink="/dashboards/{{dashboardMenuItem.id}}"
                routerLinkActive="active-dashboard"
                (click)="currentDashboardGroup = ''"
              >{{dashboardMenuItem.name}}</a>
            </li>
          </ul>
        </li>
      </ul>

      <ul class="nav navbar-nav dashboard-nav" *ngIf="(dashboardMenuObject$ | async) !== null && !(dashboardMenuObject$ | async).showInGroupFormat">
        <li *ngFor="let dashboardMenuItem of (dashboardMenuObject$ | async).dashboardsMenuItems  | filterBy: dashboardName | paginate: config" class="dashboard-list dropdwon" routerLinkActive="dashboard-active">
          <!--<span *ngIf="dashboardMenuItem.details.editComplete || dashboardMenuItem.details.creationComplete" appClickOutside (clickOutside)="dashboardStatus.id = {}" class="success-badge"><i class="fa fa-check"></i></span>-->
          <a
            routerLink="/dashboards/{{dashboardMenuItem.id}}"
            (dblclick)="openEditForm(dashboardMenuItem.id)"
            (contextmenu)="showOptions(dashboardMenuItem.id)"
            *ngIf="activeEditFormId !== dashboardMenuItem.id && itemToDelete !== dashboardMenuItem.id"
          >
            <a
              tooltip=""
              class="dashboard-menu-notification-icon"
              *ngIf="dashboardMenuItem.details.showIcon"
              appClickOutside (clickOutside)="hideDashboardNotificationIcon(dashboardMenuItem)"
            >
              <img *ngIf="!dashboardMenuItem.details.error" [src]="'assets/img/double-tick.png'" alt="">
              <img *ngIf="dashboardMenuItem.details.error" [src]="'assets/img/error.png'" alt="">
            </a>
            <span *ngIf="dashboardMenuItem.details.showName">{{dashboardMenuItem.name}}</span>
            <span *ngIf="dashboardMenuItem.details.isNew && !dashboardMenuItem.details.creationComplete">
              <img [src]="'assets/img/balls-3.svg'" alt="" style="height: 20px; width: 20px;">
              Creating dashboard..
            </span>
            <span *ngIf="dashboardMenuItem.details.edited && !dashboardMenuItem.details.editComplete">
              <img [src]="'assets/img/balls-3.svg'" alt="" style="height: 20px; width: 20px;">
              Updating dashboard..
            </span>
            <span *ngIf="dashboardMenuItem.details.toDelete">
              <img [src]="'assets/img/balls-3.svg'" alt="" style="height: 20px; width: 20px;">
              Deleting dashboard..
            </span>
          </a>
          <div *ngIf="itemToDelete === dashboardMenuItem.id" class="dashboard-delete-block">
            <small>Delete?</small>
            <button (click)="itemToDelete = ''" class="btn btn-default btn-xs"><i class="fa fa-times"></i></button>
            <button (click)="deleteDashboard(dashboardMenuItem.id)" class="btn btn-danger btn-xs"><i class="fa fa-trash"></i></button>
          </div>
          <app-edit-dashboard
            *ngIf="activeEditFormId === dashboardMenuItem.id"
            [dashboard]="dashboardMenuItem"
            (onUpdateSuccess)="closeEditForm()"
          ></app-edit-dashboard>
          <ul [ngClass]="'option-dropdown'" *ngIf="currentRightClicked == dashboardMenuItem.id" appClickOutside (clickOutside)="currentRightClicked = ''">
            <li>
              <a (click)="openEditForm(dashboardMenuItem.id)">
                <img [src]="'assets/img/edit.png'" alt="">
                Rename
              </a>
            </li>
            <li>
              <a (click)="openShareBlock(dashboardMenuItem.id)">
                <img [src]="'assets/img/share.png'" alt="">
                Share
              </a>
            </li>
            <li>
              <a (click)="openDeleteForm(dashboardMenuItem.id)" class="text-danger">
                <img [src]="'assets/img/trash.png'" alt="">
                Delete
              </a>
            </li>
          </ul>
        </li>
      </ul>
      <ul class="nav navbar-nav dashboard-nav">
        <li *ngIf="showCreateDashboardForm">
          <app-create-dashboard (onDashboardCreate)="toggleCreateDashboardForm()"></app-create-dashboard>
        </li>
        <li *ngIf="menuConfig.showDashboardCreateButton">
          <a (click)="toggleCreateDashboardForm()">
            <i class="fa {{showCreateDashboardForm ? 'fa-times' : 'fa-plus'}}"></i>
          </a>
        </li>
      </ul>
      <ul class="nav navbar-nav navbar-right dashboard-right">
        <li *ngIf="menuConfig.showPaginationButtons && (dashboardMenuObject$ | async) !== null && !(dashboardMenuObject$ | async).showInGroupFormat">
          <pagination-template *ngIf="(dashboardMenuObject$ | async).dashboardsMenuItems.length > config.itemsPerPage" #nm="paginationApi" [id]="config.id" (pageChange)="config.currentPage = $event">
            <ul class="custom-pagination pagination dashboard-pagination">
              <li class="pagination-previous" [class.disabled]="nm.isFirstPage()">
                <a (click)="nm.previous()" tooltip="previous"> <i class="fa fa-chevron-left"></i> </a>
              </li>

              <li class="pagination-next" [class.disabled]="nm.isLastPage()">
                <a (click)="nm.next()" tooltip="next"> <i class="fa fa-chevron-right"></i> </a>
              </li>
            </ul>
          </pagination-template>
        </li>
        <li
          *ngIf="menuConfig.showPaginationCounter && (dashboardMenuObject$ | async) !== null && !(dashboardMenuObject$ | async).showInGroupFormat"
        >
          <input type="number" [(ngModel)]="config.itemsPerPage" class="dashboard-pagination-input" min="1" max="{{(dashboardMenuObject$ | async).dashboardsMenuItems.length <= 8 ? (dashboardMenuObject$ | async).dashboardsMenuItems.length : 8}}" onkeydown="return false">
        </li>
        <li *ngIf="showDashboardSearch">
          <input
            type="text" size="12"
            id="dashboard_menu_search"
            [(ngModel)]="dashboardName"
            class="dashboard-search-input"
            autofocus
          >
        </li>
        <li class="dashboard-search-button"
            (click)="toggleDashboardMenuSearch()"
            *ngIf="(dashboardMenuObject$ | async) !== null && !(dashboardMenuObject$ | async).showInGroupFormat"
        >
          <a tooltip="search dashboard" style="border-right-style: none;"><i class="fa {{showDashboardSearch ? 'fa-times':'fa-search'}}"></i></a>
        </li>
        <!--<li>-->
          <!--<a-->
            <!--(click)="showDashboardGroupSettings = !showDashboardGroupSettings"-->
             <!--class=""-->
          <!--&gt;-->
            <!--<i class="fa fa-cog"></i>-->
            <!--<i class="fa fa-caret-down"></i>-->
          <!--</a>-->
          <!--<app-dashboard-group-settings-->
            <!--*ngIf="showDashboardGroupSettings"-->
            <!--[dashboardMenuObject]="dashboardMenuObject$ | async"-->
          <!--&gt;-->
          <!--</app-dashboard-group-settings>-->
        <!--</li>-->
      </ul>
    </div>
  </div>
</nav>
<app-dashboard-share *ngIf="showShareBlock"
                     [apiRootUrl]="apiRootUrl$ | async"
                     (onCloseSharing)="showShareBlock = false"
>
</app-dashboard-share>
