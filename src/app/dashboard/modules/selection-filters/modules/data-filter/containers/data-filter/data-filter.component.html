<div class="data-filter-container">
  <div class="data-item-selection-container">
    <table class="table table-bordered">
      <tr>
        <th><span class="d-flex align-items-center pt-1 pb-1">Settings
            {{interventionName ? 'for ' + interventionName : ''}}</span></th>
      </tr>
      <tr>
        <td class="position-relative">
          <!-- sharing section -->
          <app-sharing-card [userAccesses]="userAccesses" [userGroupAccesses]="userGroupAccesses"
            [publicAccess]="publicAccess" (updateSharing)="onUpdateSharingItem($event)"></app-sharing-card>
          <!-- end of sharing section -->

          <h6 class="text-muted mt-4">Intervention settings</h6>
          <mat-divider></mat-divider>
          <mat-form-field class="w-100 mt-2">
            <mat-label>Bottleneck period type</mat-label>
            <mat-select [value]="bottleneckPeriodType" (selectionChange)="onSelectBottleneckPeriodType($event.value)">
              <mat-option [value]="periodType.id" *ngFor="let periodType of periodTypes">{{periodType.name}}
              </mat-option>
            </mat-select>
          </mat-form-field>

          <h6 class="text-muted mt-2">Indicator settings</h6>
          <mat-divider></mat-divider>

          <!-- data configuration section -->
          <div class="mt-3">
            <mat-checkbox [ngModel]="generalDataConfiguration.useShortNameAsLabel"
              (change)="onUpdateGeneralDataConfiguration($event.checked, 'useShortNameAsLabel')">Use
              short names as labels</mat-checkbox>
          </div>

          <h6 class="mt-2">Legend Definitions <small>(Applicable across all indicators)</small></h6>
          <!-- <mat-divider></mat-divider> -->
          <app-legend-definition-list [legendDefinitions]="generalDataConfiguration.legendDefinitions"
            (updateLegendDefinitions)="onUpdateGeneralDataConfiguration($event, 'legendDefinitions')">
          </app-legend-definition-list>
          <!-- end of data configuration section -->
        </td>
      </tr>
    </table>

  </div>
  <div class="determinant-selection-container">
    <app-determinant-list [determinants]="determinants" [dataFilterTypes]="dataFilterTypes"
      [dataFilterGroups]="dataFilterGroups$ | async" (setDataFilterGroup)="onSetDataFilterGroup($event)"
      [currentDataFilterGroup]="currentDataFilterGroup$ | async" [dataFilterItems]="dataFilterItems$ | async"
      [selectedItems]="selectedItems" [selectedDeterminantId]="selectedDeterminantId"
      [determinantPreferences]="determinantPreferences" [generalDataConfiguration]="generalDataConfiguration"
      (toggleDataFilterType)="onToggleDataFilterType($event)" (selectDataItem)="onSelectDataItem($event)"
      (selectDeterminant)="onSelectDeterminant($event)" (removeDeterminantMember)="onRemoveDataItem($event)"
      (removeAllDeterminantMembers)="onDeselectAllItems()" (updateMember)="onUpdateDataItem($event)">
    </app-determinant-list>
  </div>
</div>

<div class="data-filter-btns">
  <button mat-stroked-button title="Close data filter" (click)="close($event)">
    Close
  </button>
  <button mat-stroked-button title="Update visualization(s) with selected items" [disabled]="selectedItems.length === 0"
    (click)="onDataFilterUpdate($event)">
    Update
  </button>
</div>
